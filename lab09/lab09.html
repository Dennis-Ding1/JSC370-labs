<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">

<style type="text/css">
@font-face {
font-family: octicons-link;
src: url(data:font/woff;charset=utf-8;base64,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) format('woff');
}
body {
-webkit-text-size-adjust: 100%;
text-size-adjust: 100%;
color: #333;
font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
font-size: 16px;
line-height: 1.6;
word-wrap: break-word;
}
a {
background-color: transparent;
}
a:active,
a:hover {
outline: 0;
}
strong {
font-weight: bold;
}
h1 {
font-size: 2em;
margin: 0.67em 0;
}
img {
border: 0;
}
hr {
box-sizing: content-box;
height: 0;
}
pre {
overflow: auto;
}
code,
kbd,
pre {
font-family: monospace, monospace;
font-size: 1em;
}
input {
color: inherit;
font: inherit;
margin: 0;
}
html input[disabled] {
cursor: default;
}
input {
line-height: normal;
}
input[type="checkbox"] {
box-sizing: border-box;
padding: 0;
}
table {
border-collapse: collapse;
border-spacing: 0;
}
td,
th {
padding: 0;
}
* {
box-sizing: border-box;
}
input {
font: 13px / 1.4 Helvetica, arial, nimbussansl, liberationsans, freesans, clean, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
}
a {
color: #4078c0;
text-decoration: none;
}
a:hover,
a:active {
text-decoration: underline;
}
hr {
height: 0;
margin: 15px 0;
overflow: hidden;
background: transparent;
border: 0;
border-bottom: 1px solid #ddd;
}
hr:before {
display: table;
content: "";
}
hr:after {
display: table;
clear: both;
content: "";
}
h1,
h2,
h3,
h4,
h5,
h6 {
margin-top: 15px;
margin-bottom: 15px;
line-height: 1.1;
}
h1 {
font-size: 30px;
}
h2 {
font-size: 21px;
}
h3 {
font-size: 16px;
}
h4 {
font-size: 14px;
}
h5 {
font-size: 12px;
}
h6 {
font-size: 11px;
}
blockquote {
margin: 0;
}
ul,
ol {
padding: 0;
margin-top: 0;
margin-bottom: 0;
}
ol ol,
ul ol {
list-style-type: lower-roman;
}
ul ul ol,
ul ol ol,
ol ul ol,
ol ol ol {
list-style-type: lower-alpha;
}
dd {
margin-left: 0;
}
code {
font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
font-size: 12px;
}
pre {
margin-top: 0;
margin-bottom: 0;
font: 12px Consolas, "Liberation Mono", Menlo, Courier, monospace;
}
.select::-ms-expand {
opacity: 0;
}
.octicon {
font: normal normal normal 16px/1 octicons-link;
display: inline-block;
text-decoration: none;
text-rendering: auto;
-webkit-font-smoothing: antialiased;
-moz-osx-font-smoothing: grayscale;
-webkit-user-select: none;
-moz-user-select: none;
-ms-user-select: none;
user-select: none;
}
.octicon-link:before {
content: '\f05c';
}
.markdown-body:before {
display: table;
content: "";
}
.markdown-body:after {
display: table;
clear: both;
content: "";
}
.markdown-body>*:first-child {
margin-top: 0 !important;
}
.markdown-body>*:last-child {
margin-bottom: 0 !important;
}
a:not([href]) {
color: inherit;
text-decoration: none;
}
.anchor {
display: inline-block;
padding-right: 2px;
margin-left: -18px;
}
.anchor:focus {
outline: none;
}
h1,
h2,
h3,
h4,
h5,
h6 {
margin-top: 1em;
margin-bottom: 16px;
font-weight: bold;
line-height: 1.4;
}
h1 .octicon-link,
h2 .octicon-link,
h3 .octicon-link,
h4 .octicon-link,
h5 .octicon-link,
h6 .octicon-link {
color: #000;
vertical-align: middle;
visibility: hidden;
}
h1:hover .anchor,
h2:hover .anchor,
h3:hover .anchor,
h4:hover .anchor,
h5:hover .anchor,
h6:hover .anchor {
text-decoration: none;
}
h1:hover .anchor .octicon-link,
h2:hover .anchor .octicon-link,
h3:hover .anchor .octicon-link,
h4:hover .anchor .octicon-link,
h5:hover .anchor .octicon-link,
h6:hover .anchor .octicon-link {
visibility: visible;
}
h1 {
padding-bottom: 0.3em;
font-size: 2.25em;
line-height: 1.2;
border-bottom: 1px solid #eee;
}
h1 .anchor {
line-height: 1;
}
h2 {
padding-bottom: 0.3em;
font-size: 1.75em;
line-height: 1.225;
border-bottom: 1px solid #eee;
}
h2 .anchor {
line-height: 1;
}
h3 {
font-size: 1.5em;
line-height: 1.43;
}
h3 .anchor {
line-height: 1.2;
}
h4 {
font-size: 1.25em;
}
h4 .anchor {
line-height: 1.2;
}
h5 {
font-size: 1em;
}
h5 .anchor {
line-height: 1.1;
}
h6 {
font-size: 1em;
color: #777;
}
h6 .anchor {
line-height: 1.1;
}
p,
blockquote,
ul,
ol,
dl,
table,
pre {
margin-top: 0;
margin-bottom: 16px;
}
hr {
height: 4px;
padding: 0;
margin: 16px 0;
background-color: #e7e7e7;
border: 0 none;
}
ul,
ol {
padding-left: 2em;
}
ul ul,
ul ol,
ol ol,
ol ul {
margin-top: 0;
margin-bottom: 0;
}
li>p {
margin-top: 16px;
}
dl {
padding: 0;
}
dl dt {
padding: 0;
margin-top: 16px;
font-size: 1em;
font-style: italic;
font-weight: bold;
}
dl dd {
padding: 0 16px;
margin-bottom: 16px;
}
blockquote {
padding: 0 15px;
color: #777;
border-left: 4px solid #ddd;
}
blockquote>:first-child {
margin-top: 0;
}
blockquote>:last-child {
margin-bottom: 0;
}
table {
display: block;
width: 100%;
overflow: auto;
word-break: normal;
word-break: keep-all;
}
table th {
font-weight: bold;
}
table th,
table td {
padding: 6px 13px;
border: 1px solid #ddd;
}
table tr {
background-color: #fff;
border-top: 1px solid #ccc;
}
table tr:nth-child(2n) {
background-color: #f8f8f8;
}
img {
max-width: 100%;
box-sizing: content-box;
background-color: #fff;
}
code {
padding: 0;
padding-top: 0.2em;
padding-bottom: 0.2em;
margin: 0;
font-size: 85%;
background-color: rgba(0,0,0,0.04);
border-radius: 3px;
}
code:before,
code:after {
letter-spacing: -0.2em;
content: "\00a0";
}
pre>code {
padding: 0;
margin: 0;
font-size: 100%;
word-break: normal;
white-space: pre;
background: transparent;
border: 0;
}
.highlight {
margin-bottom: 16px;
}
.highlight pre,
pre {
padding: 16px;
overflow: auto;
font-size: 85%;
line-height: 1.45;
background-color: #f7f7f7;
border-radius: 3px;
}
.highlight pre {
margin-bottom: 0;
word-break: normal;
}
pre {
word-wrap: normal;
}
pre code {
display: inline;
max-width: initial;
padding: 0;
margin: 0;
overflow: initial;
line-height: inherit;
word-wrap: normal;
background-color: transparent;
border: 0;
}
pre code:before,
pre code:after {
content: normal;
}
kbd {
display: inline-block;
padding: 3px 5px;
font-size: 11px;
line-height: 10px;
color: #555;
vertical-align: middle;
background-color: #fcfcfc;
border: solid 1px #ccc;
border-bottom-color: #bbb;
border-radius: 3px;
box-shadow: inset 0 -1px 0 #bbb;
}
.pl-c {
color: #969896;
}
.pl-c1,
.pl-s .pl-v {
color: #0086b3;
}
.pl-e,
.pl-en {
color: #795da3;
}
.pl-s .pl-s1,
.pl-smi {
color: #333;
}
.pl-ent {
color: #63a35c;
}
.pl-k {
color: #a71d5d;
}
.pl-pds,
.pl-s,
.pl-s .pl-pse .pl-s1,
.pl-sr,
.pl-sr .pl-cce,
.pl-sr .pl-sra,
.pl-sr .pl-sre {
color: #183691;
}
.pl-v {
color: #ed6a43;
}
.pl-id {
color: #b52a1d;
}
.pl-ii {
background-color: #b52a1d;
color: #f8f8f8;
}
.pl-sr .pl-cce {
color: #63a35c;
font-weight: bold;
}
.pl-ml {
color: #693a17;
}
.pl-mh,
.pl-mh .pl-en,
.pl-ms {
color: #1d3e81;
font-weight: bold;
}
.pl-mq {
color: #008080;
}
.pl-mi {
color: #333;
font-style: italic;
}
.pl-mb {
color: #333;
font-weight: bold;
}
.pl-md {
background-color: #ffecec;
color: #bd2c00;
}
.pl-mi1 {
background-color: #eaffea;
color: #55a532;
}
.pl-mdr {
color: #795da3;
font-weight: bold;
}
.pl-mo {
color: #1d3e81;
}
kbd {
display: inline-block;
padding: 3px 5px;
font: 11px Consolas, "Liberation Mono", Menlo, Courier, monospace;
line-height: 10px;
color: #555;
vertical-align: middle;
background-color: #fcfcfc;
border: solid 1px #ccc;
border-bottom-color: #bbb;
border-radius: 3px;
box-shadow: inset 0 -1px 0 #bbb;
}
.task-list-item {
list-style-type: none;
}
.task-list-item+.task-list-item {
margin-top: 3px;
}
.task-list-item input {
margin: 0 0.35em 0.25em -1.6em;
vertical-align: middle;
}
:checked+.radio-label {
z-index: 1;
position: relative;
border-color: #4078c0;
}
.sourceLine {
display: inline-block;
}
code .kw { color: #000000; }
code .dt { color: #ed6a43; }
code .dv { color: #009999; }
code .bn { color: #009999; }
code .fl { color: #009999; }
code .ch { color: #009999; }
code .st { color: #183691; }
code .co { color: #969896; }
code .ot { color: #0086b3; }
code .al { color: #a61717; }
code .fu { color: #63a35c; }
code .er { color: #a61717; background-color: #e3d2d2; }
code .wa { color: #000000; }
code .cn { color: #008080; }
code .sc { color: #008080; }
code .vs { color: #183691; }
code .ss { color: #183691; }
code .im { color: #000000; }
code .va {color: #008080; }
code .cf { color: #000000; }
code .op { color: #000000; }
code .bu { color: #000000; }
code .ex { color: #000000; }
code .pp { color: #999999; }
code .at { color: #008080; }
code .do { color: #969896; }
code .an { color: #008080; }
code .cv { color: #008080; }
code .in { color: #008080; }
</style>
<style>
body {
box-sizing: border-box;
min-width: 200px;
max-width: 980px;
margin: 0 auto;
padding: 45px;
padding-top: 0px;
}
</style>


</head>

<body>

<h1 id="lab-9---hpc">Lab 9 - HPC</h1>
<h1 id="learning-goals">Learning goals</h1>
<p>In this lab, you are expected to practice the following skills:</p>
<ul>
<li>Evaluate whether a problem can be parallelized or not.</li>
<li>Practice with the parallel package.</li>
<li>Use Rscript to submit jobs.</li>
</ul>
<h2 id="problem-1">Problem 1</h2>
<p>Give yourself a few minutes to think about what you learned about
parallelization. List three examples of problems that you believe may be
solved using parallel computing, and check for packages on the HPC CRAN
task view that may be related to it.</p>
<ul>
<li><p>cross-validation in machine learning</p></li>
<li><p>caret -&gt; supports parallel cross-validation with
<code>doParallel</code></p></li>
<li><p>mlr, foreach, doParallel -&gt; for parallel model
training</p></li>
<li><p>bootstrapping</p></li>
<li><p>boot -&gt; for bootstrapping</p></li>
<li><p>parallel -&gt; parallelize resampling</p></li>
<li><p>markov chain monte carlo</p></li>
<li><p>parallel</p></li>
<li><p>rstan -&gt; for stan for bayesian modeling</p></li>
<li><p>RcppParallel -&gt; parallel mcmc sampling</p></li>
<li><p>nimle -&gt; customize bayesian inference</p></li>
</ul>
<h2 id="problem-2-pre-parallelization">Problem 2:
Pre-parallelization</h2>
<p>The following functions can be written to be more efficient without
using <code>parallel</code>:</p>
<ol style="list-style-type: decimal">
<li>This function generates a <code>n x k</code> dataset with all its
entries having a Poisson distribution with mean
<code>lambda</code>.</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>fun1 <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">k =</span> <span class="dv">4</span>, <span class="at">lambda =</span> <span class="dv">4</span>) {</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>  </span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x, <span class="fu">rpois</span>(k, lambda))</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>  </span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>}</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>fun1alt <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">k =</span> <span class="dv">4</span>, <span class="at">lambda =</span> <span class="dv">4</span>) {</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>  <span class="co"># YOUR CODE HERE</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>  <span class="fu">matrix</span>(<span class="fu">rpois</span>(n<span class="sc">*</span>k, <span class="at">lambda=</span>lambda), <span class="at">ncol=</span>k)</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>}</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a><span class="co"># Benchmarking</span></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>microbenchmark<span class="sc">::</span><span class="fu">microbenchmark</span>(</span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>  <span class="fu">fun1</span>(<span class="dv">100</span>),</span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a>  <span class="fu">fun1alt</span>(<span class="dv">100</span>),</span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a>  <span class="at">unit=</span><span class="st">&quot;ns&quot;</span></span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Unit: nanoseconds
##          expr    min       lq      mean   median     uq     max neval
##     fun1(100) 166802 198850.5 305310.01 231151.5 244551 8035102   100
##  fun1alt(100)   9601  10701.0  21705.99  12101.0  13901  897001   100</code></pre>
<p>How much faster?</p>
<p>About 408306.06/26082.01 = 15.65 times faster.</p>
<ol start="2" style="list-style-type: decimal">
<li>Find the column max (hint: Checkout the function
<code>max.col()</code>).</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Data Generating Process (10 x 10,000 matrix)</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="fl">1e4</span>), <span class="at">nrow=</span><span class="dv">10</span>)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co"># Find each column&#39;s max value</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>fun2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>  <span class="fu">apply</span>(x, <span class="dv">2</span>, max)</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>}</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>fun2alt <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>  <span class="co"># YOUR CODE HERE</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>  x[<span class="fu">cbind</span>(<span class="fu">max.col</span>(<span class="fu">t</span>(x)), <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(x))]</span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>}</span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="co"># Benchmarking</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>bench <span class="ot">&lt;-</span> microbenchmark<span class="sc">::</span><span class="fu">microbenchmark</span>(</span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a>  <span class="fu">fun2</span>(x),</span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a>  <span class="fu">fun2alt</span>(x),</span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a>  <span class="at">unit=</span><span class="st">&quot;us&quot;</span></span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">plot</span>(bench)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">autoplot</span>(bench) <span class="sc">+</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<h2 id="problem-3-parallelize-everything">Problem 3: Parallelize
everything</h2>
<p>We will now turn our attention to non-parametric <a href="https://en.wikipedia.org/wiki/Bootstrapping_(statistics)">bootstrapping</a>.
Among its many uses, non-parametric bootstrapping allow us to obtain
confidence intervals for parameter estimates without relying on
parametric assumptions.</p>
<p>The main assumption is that we can approximate many experiments by
resampling observations from our original dataset, which reflects the
population.</p>
<p>This function implements the non-parametric bootstrap:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>my_boot <span class="ot">&lt;-</span> <span class="cf">function</span>(dat, stat, R, <span class="at">ncpus =</span> <span class="dv">1</span><span class="dt">L</span>) {</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>  <span class="co"># Getting the random indices</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(dat)</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  idx <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">sample.int</span>(n, n<span class="sc">*</span>R, <span class="cn">TRUE</span>), <span class="at">nrow=</span>n, <span class="at">ncol=</span>R)</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>  <span class="co"># Making the cluster using `ncpus`</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>  <span class="co"># STEP 1: GOES HERE</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>  cl <span class="ot">&lt;-</span> <span class="fu">makePSOCKcluster</span>(ncpus)</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>  <span class="co"># created worker nodes</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>  <span class="co"># creating cluster for parallel computing</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>  <span class="co"># `ncpus` specifying using multiple CPU cores</span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>  <span class="co"># PSOCK parallel socket cluster</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>  <span class="co"># STEP 2: GOES HERE</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>  <span class="co"># on.exit(stopCluster(cl))</span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>  <span class="co"># export the variables to the cluster</span></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a>  <span class="fu">clusterExport</span>(cl, <span class="at">varlist =</span> <span class="fu">c</span>(<span class="st">&quot;idx&quot;</span>, <span class="st">&quot;dat&quot;</span>, <span class="st">&quot;stat&quot;</span>), <span class="at">envir =</span> <span class="fu">environment</span>())</span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a>  <span class="co"># sending the variables to all worker nodes</span></span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a>  <span class="co"># each run in isolated environment, don&#39;t have access to global variable</span></span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a>  <span class="co"># idx -&gt; resampling indices for bootstrapping</span></span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a>  <span class="co"># dat -&gt; dataset</span></span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a>  <span class="co"># stat -&gt; the statistical function that we use to compute the estimates</span></span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a>  </span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a>  <span class="co"># STEP 3: THIS FUNCTION NEEDS TO BE REPLACED WITH parLapply</span></span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a>  ans <span class="ot">&lt;-</span> <span class="fu">parLapply</span>(cl, <span class="fu">seq_len</span>(R), <span class="cf">function</span>(i) {</span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a>    <span class="fu">stat</span>(dat[idx[,i], , <span class="at">drop=</span><span class="cn">FALSE</span>])</span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a>  })</span>
<span id="cb6-29"><a href="#cb6-29" tabindex="-1"></a>  </span>
<span id="cb6-30"><a href="#cb6-30" tabindex="-1"></a>  <span class="co"># Coercing the list into a matrix</span></span>
<span id="cb6-31"><a href="#cb6-31" tabindex="-1"></a>  ans <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, ans)</span>
<span id="cb6-32"><a href="#cb6-32" tabindex="-1"></a>  </span>
<span id="cb6-33"><a href="#cb6-33" tabindex="-1"></a>  <span class="co"># STEP 4: GOES HERE</span></span>
<span id="cb6-34"><a href="#cb6-34" tabindex="-1"></a>  <span class="fu">stopCluster</span>(cl)</span>
<span id="cb6-35"><a href="#cb6-35" tabindex="-1"></a>  <span class="co"># why? To free up system resources</span></span>
<span id="cb6-36"><a href="#cb6-36" tabindex="-1"></a></span>
<span id="cb6-37"><a href="#cb6-37" tabindex="-1"></a>  ans</span>
<span id="cb6-38"><a href="#cb6-38" tabindex="-1"></a>  </span>
<span id="cb6-39"><a href="#cb6-39" tabindex="-1"></a>}</span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Use the previous pseudocode, and make it work with
<code>parallel</code>. Here is just an example for you to try:</li>
</ol>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co"># Bootstrap of a linear regression model</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>my_stat <span class="ot">&lt;-</span> <span class="cf">function</span>(d) <span class="fu">coef</span>(<span class="fu">lm</span>(y<span class="sc">~</span>x, <span class="at">data =</span> d))</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co"># DATA SIM</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">500</span> </span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">rnorm</span>(n)) </span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>y <span class="ot">&lt;-</span> x<span class="sc">*</span><span class="dv">5</span> <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co"># Check if we get something similar as lm</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a>ans0 <span class="ot">&lt;-</span> <span class="fu">confint</span>(<span class="fu">lm</span> (y<span class="sc">~</span>x))</span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;OLS CI </span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## OLS CI</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">print</span>(ans0)</span></code></pre></div>
<pre><code>##                  2.5 %     97.5 %
## (Intercept) -0.1379033 0.04797344
## x            4.8650100 5.04883353</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>ans1 <span class="ot">&lt;-</span> <span class="fu">my_boot</span>(<span class="at">dat =</span> <span class="fu">data.frame</span>(x, y), my_stat, <span class="at">R=</span>R, <span class="at">ncpus =</span> <span class="dv">4</span>)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>qs <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">975</span>)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Bootstrap CI </span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Bootstrap CI</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">t</span>(<span class="fu">apply</span>(ans1, <span class="dv">2</span>, quantile, <span class="at">probs =</span> qs)))</span></code></pre></div>
<pre><code>##                   2.5%      97.5%
## (Intercept) -0.1386903 0.04856752
## x            4.8685162 5.04351239</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Check whether your version actually goes faster than the
non-parallel version:</li>
</ol>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># your code here</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="fu">detectCores</span>()</span></code></pre></div>
<pre><code>## [1] 16</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># non-parallel 1 core</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="fu">system.time</span>(<span class="fu">my_boot</span>(<span class="at">dat =</span> <span class="fu">data.frame</span>(x, y), my_stat, <span class="at">R =</span> <span class="dv">4000</span>, <span class="at">ncpus =</span> <span class="dv">1</span><span class="dt">L</span>))</span></code></pre></div>
<pre><code>## 用户 系统 流逝 
## 0.03 0.00 1.85</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co"># parallel 4 core</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="fu">system.time</span>(<span class="fu">my_boot</span>(<span class="at">dat =</span> <span class="fu">data.frame</span>(x, y), my_stat, <span class="at">R =</span> <span class="dv">4000</span>, <span class="at">ncpus =</span> <span class="dv">4</span><span class="dt">L</span>))</span></code></pre></div>
<pre><code>## 用户 系统 流逝 
## 0.04 0.00 1.03</code></pre>
<p>4 cores has smaller elapsed time.</p>
<h2 id="problem-4-compile-this-markdown-document-using-rscript">Problem
4: Compile this markdown document using Rscript</h2>
<p>Once you have saved this Rmd file, try running the following command
in your terminal:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="ex">Rscript</span> <span class="at">--vanilla</span> <span class="at">-e</span> <span class="st">&#39;rmarkdown::render(&quot;D:/Documents/U of T 大三/JSC370/JSC370-labs/lab09/lab09.Rmd&quot;)&#39;</span> <span class="kw">&amp;</span></span></code></pre></div>
<p>Where <code>[full-path-to-your-Rmd-file.Rmd]</code> should be replace
with the full path to your Rmd file… :).</p>

</body>
</html>
